import mx.transitions.Tween;import mx.utils.Delegate;import flash.filters.DropShadowFilter;import flash.filters.BevelFilter;import flash.geom.ColorTransform;import flash.geom.Transform;import flash.geom.Point;//class Mole {	//	private var colorTrans:ColorTransform;	private var manager:MoleManager;	private var question:Question;	private var clip:MovieClip;	private var masker:MovieClip;	private var trans:Transform;	private var shadowLeft:MovieClip;	private var shadowCenter:MovieClip;	private var shadowRight:MovieClip;	private var showing:Boolean;	private var hideDelay:Number;	private var busy:Boolean;	//	public function Mole(question:Question, index:Number, manager:MoleManager) {		colorTrans = new ColorTransform();		this.question = question;		this.manager = manager;		clip = LZGame.getStage().createEmptyMovieClip("mole_"+index, LZGame.getStage().getNextHighestDepth());		showing = false;		createShadow();		createText(question.getResponses()[0].getStimulus().getContent(), index);		clip._alpha = 0;		busy = false;		clip.onPress = Delegate.create(this, hit);	}		private function hit():Void {		if (!busy) {			manager.hit(this);			busy = true;				}	}	public function strikeDown():Void {		clearInterval(hideDelay);		hideDelay = setInterval(this, "dropDown", 300);	}	private function dropDown():Void {		clearInterval(hideDelay);		clip.txt._y += ((clip.txt.txtfield._height / 5) * 2);		hideDelay = setInterval(this, "hideText", 1000);	}	public function strikeBounce():Void {		clearInterval(hideDelay);		colorTrans.redOffset = 255;		colorTrans.greenOffset = 0;		colorTrans.blueOffset = 0;		var trans:Transform = new Transform(clip.txt);		trans.colorTransform = colorTrans;		var twn:Tween = new Tween(clip.txt, "_y", mx.transitions.easing.Regular.easeOut, clip.txt._y, clip.txt._y - 40, .25, true);		twn.onMotionFinished = Delegate.create(this, jumpDown);	}	public function jumpDown():Void {		var twn:Tween = new Tween(clip.txt, "_y", mx.transitions.easing.Regular.easeIn, clip.txt._y, clip.txt._y + 40, .25, true);				twn.onMotionFinished = Delegate.create(this, hideText);	}		private function createText(str:String, index:Number):Void {		clip.txt = clip.createEmptyMovieClip("txt", clip.getNextHighestDepth());		clip.txt.createTextField("txtfield", 0, 0, 0, 0, 0);		clip.txt.txtfield.autoSize = true;		clip.txt.txtfield.selectable = false;		clip.txt.txtfield.embedFonts = true;		clip.txt.txtfield.setNewTextFormat(new TextFormat("EmbedArial", 12, 0xFFFFFF));		clip.txt.filters = new Array(			new DropShadowFilter(4, 25, 0x333336, 5, 4, 4, 2, 2, false, false, false),			new BevelFilter(3, 45, 0xE8D4BE, 0.75, 0x5D3938, 0.35, 3, 3, 3, 3, "inner", false)			);		clip.txt.txtfield.text = str;				masker = LZGame.getStage().attachMovie("masker", "masker_"+index, LZGame.getStage().getNextHighestDepth());		masker._x = clip._x;		masker._y = clip._y;		clip.txt.setMask(masker);	}		private function createShadow():Void {		shadowLeft = clip.attachMovie("shadow_left", "shadow_left", clip.getNextHighestDepth());		shadowLeft._x = 0 - shadowLeft._width;		shadowCenter = clip.attachMovie("shadow_center", "shadow_center", clip.getNextHighestDepth());		shadowCenter._width = clip.txt.txtfield._width;		shadowRight = clip.attachMovie("shadow_right", "shadow_right", clip.getNextHighestDepth());		shadowRight._x = shadowCenter._width;		shadowRight.onEnterFrame = Delegate.create(this, attachRight);	}	private function attachRight():Void {		shadowCenter._width = clip.txt._width;		shadowRight._x = shadowCenter._width;	}		public function popUp():Void {		showing = true;		clip._alpha = 100;		clip.txt._y = 5;		var twn:Tween = new Tween(clip, "_width", mx.transitions.easing.Elastic.easeOut, 20, clip.txt.txtfield._width, .5, true);		twn.onMotionFinished = Delegate.create(this, showText);	}	public function showText():Void {		clearInterval(hideDelay);		new Tween(clip.txt, "_y", mx.transitions.easing.Elastic.easeOut, 5, -clip.txt._height * (2/3) - 2, .75, true);		hideDelay = setInterval(this, "hideText", 1700);		busy = false;	}		public function hideText():Void {		busy = true;		clearInterval(hideDelay);		var twn:Tween = new Tween(clip.txt, "_y", mx.transitions.easing.Regular.easeIn, clip.txt._y, 5, .35, true);		twn.onMotionFinished = Delegate.create(this, popDown);	}	public function popDown():Void {		var twn:Tween = new Tween(clip, "_width", mx.transitions.easing.Elastic.easeIn, clip.txt.txtfield._width, 20, .5, true);		new Tween(clip, "_alpha", mx.transitions.easing.Regular.easeOut, 100, 0, 1.5, true);		twn.onMotionFinished = Delegate.create(this, stopShowing);	}	public function stopShowing():Void {		manager.deactivateMole(this);		showing = false;		var trans:Transform = new Transform(clip.txt);		trans.colorTransform = new ColorTransform();		colorTrans.redOffset = 0;		colorTrans.greenOffset = 0;		colorTrans.blueOffset = 0;	}		public function destroy():Void {		delete clip.onPress;		delete shadowRight.onEnterFrame;		clip.txt.setMask(null);		removeMovieClip(clip);		removeMovieClip(masker);		delete this;	}	public function calcNewPosition():Point {		var xx:Number = Math.random() * (600 - clip._width);		var yy:Number = 100 + Math.random() * (300 - clip._height);		applyTextSize(yy);		return new Point(xx,yy);	}	public function setNewPosition(xx:Number, yy:Number):Void {		clip._x = xx;		clip._y = yy;		applyTextSize(yy);		applyMask();	}	private function applyTextSize(yy:Number):Void {		var scale:Number = Math.round(10 + (10 * (yy / 150)));		clip.txt.txtfield.setTextFormat(new TextFormat("EmbedArial", scale, 0xFFFFFF));		if (clip._x + clip.txt.txtfield._width > 600) {			clip._x = 600 - clip.txt.txtfield._width;		}	}	private function applyMask():Void {		masker._width = clip.txt.txtfield._width;		masker._height = clip.txt.txtfield._height * 2.5;		masker._x = clip._x;		masker._y = (clip._y + clip.shadow_center._y + ((clip.shadow_center._height / 5) * 2)) - (masker._height);	}	public function getOption():Response {		return question.getResponses()[0];	}		public function getLeftSide():Number {		return clip._x;	}	public function getRightSide():Number {		return clip._x + clip._width;	}	public function getTopSide():Number {		return clip._y;	}	public function getBottomSide():Number {		return clip._y + clip._height;	}	public function isShowing():Boolean {		return showing;	}}